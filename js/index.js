"use strict";const appPuzzle=()=>{const l=document.getElementById("app__puzzle"),e=document.getElementById("app__shuffle"),t=document.getElementById("app__counter"),a=Array.from(l.querySelectorAll(".app__puzzle--btn")),r=document.querySelector(".preloader"),n=new Array(16).fill(0).map((e,t)=>t+1),s=16,o=16,c=4;let d=!1,i=[],u=null,y=null,p=null,m=0;t.textContent=m;const f=()=>{m++,t.textContent=m},x=()=>{r.classList.contains("hide")||r.classList.add("hide")},h=e=>{var t=e.flat();for(let e=0;e<n.length;e++)if(t[e]!==n[e])return!1;return!0},v=()=>{h(i)?(m=0,l.classList.add("lock"),setTimeout(()=>l.classList.remove("won"),70)):setTimeout(()=>l.classList.add("won"),70)},g=(e,t,r)=>{e.style.transform=`translate3D(${100*t}%, ${100*r}%, 0)`},b=r=>{for(let t=0;t<r.length;t++)for(let e=0;e<r[t].length;e++){var l=r[t][e],l=a[l-1];g(l,e,t)}v()},k=(r,l)=>{for(let t=0;t<l.length;t++)for(let e=0;e<l[t].length;e++)if(l[t][e]===r)return{y:t,x:e};return null},L=(e,t)=>{var r=Math.abs(e.x-t.x),l=Math.abs(e.y-t.y);return!(1!==r&&1!==l||e.x!==t.x&&e.y!==t.y)},w=(e,t,r)=>{var l=r[e.y][e.x];r[e.y][e.x]=r[t.y][t.x],r[t.y][t.x]=l},z=({blankCoords:r,matrix:l,blockedCoords:a})=>{const n=[];for(let t=0;t<l.length;t++)for(let e=0;e<l[t].length;e++)!L({x:e,y:t},r)||a&&a.x===e&&a.y===t||n.push({x:e,y:t});return n};const _=(e,t)=>{e.y>=i.length||e.y<0||e.x>=i.length||e.x<0||(f(),w(e,t,i),b(i))};l.addEventListener("click",({target:e})=>{var t;d||(e=e.closest(".app__puzzle--btn"))&&(e=Number(e.dataset.matrixId),e=k(e,i),t=k(s,i),e=e,t=t,L(e,t)&&(f(),w(e,t,i),b(i)))}),e.addEventListener("click",()=>{d||(m=0,t.textContent=m,l.classList.remove("lock"),d=!0,y=0,clearInterval(p),l.classList.add("appShuffle"),0===y&&(p=setInterval(()=>{var e,t,r;e=i,t=k(s,e),r=(r=z({blankCoords:t,matrix:e,blockedCoords:u}))[Math.floor(Math.random()*r.length)],w(t,r,e),u=t,b(i),100<=(y+=1)&&(l.classList.remove("appShuffle"),clearInterval(p),d=!1)},70)))}),document.body.addEventListener("keydown",e=>{if(!d&&e.key.includes("Arrow")){var t=k(s,i),r={x:t.x,y:t.y},e=e.key.split("Arrow")[1].toLowerCase(),l=r,r=t;switch(e){case"up":l.y+=1;break;case"down":--l.y;break;case"left":l.x+=1;break;case"right":--l.x}_(l,r)}});if(setTimeout(x,3e3),a.length<o)throw new Error(`Должно быть ровно ${o} items in HTML`);a[o-1].style.display="none";var C=a.map(e=>Number(e.dataset.matrixId));i=(e=>{const t=[[],[],[],[]];let r=0,l=0;for(var a of e)l>=c&&(r++,l=0),t[r][l]=a,l++;return t})(C),b(i),v()};appPuzzle();