"use strict";const appPuzzle=()=>{const l=document.getElementById("app__puzzle"),e=document.getElementById("app__shuffle"),a=Array.from(l.querySelectorAll(".app__puzzle--btn")),r=new Array(16).fill(0).map((e,t)=>t+1),n=16,t=16,s=4;let o=!1,d=[],u=null,c=null,y=null;const i=e=>{var t=e.flat();for(let e=0;e<r.length;e++)if(t[e]!==r[e])return!1;return!0},f=()=>{i(d)?setTimeout(()=>l.classList.remove("won"),70):setTimeout(()=>l.classList.add("won"),70)},p=(e,t,r)=>{e.style.transform=`translate3D(${100*t}%, ${100*r}%, 0)`},h=r=>{for(let t=0;t<r.length;t++)for(let e=0;e<r[t].length;e++){var l=r[t][e],l=a[l-1];p(l,e,t)}f()},x=(r,l)=>{for(let t=0;t<l.length;t++)for(let e=0;e<l[t].length;e++)if(l[t][e]===r)return{y:t,x:e};return null},m=(e,t)=>{var r=Math.abs(e.x-t.x),l=Math.abs(e.y-t.y);return!(1!==r&&1!==l||e.x!==t.x&&e.y!==t.y)},v=(e,t,r)=>{var l=r[e.y][e.x];r[e.y][e.x]=r[t.y][t.x],r[t.y][t.x]=l},g=({blankCoords:r,matrix:l,blockedCoords:a})=>{const n=[];for(let t=0;t<l.length;t++)for(let e=0;e<l[t].length;e++)!m({x:e,y:t},r)||a&&a.x===e&&a.y===t||n.push({x:e,y:t});return n};const b=(e,t)=>{e.y>=d.length||e.y<0||e.x>=d.length||e.x<0||(v(e,t,d),h(d))};l.addEventListener("click",({target:e})=>{var t;o||(e=e.closest(".app__puzzle--btn"))&&(e=Number(e.dataset.matrixId),e=x(e,d),t=x(n,d),e=e,t=t,m(e,t)&&(v(e,t,d),h(d)))}),e.addEventListener("click",()=>{o||(o=!0,c=0,clearInterval(y),l.classList.add("appShuffle"),0===c&&(y=setInterval(()=>{var e,t,r;e=d,t=x(n,e),r=(r=g({blankCoords:t,matrix:e,blockedCoords:u}))[Math.floor(Math.random()*r.length)],v(t,r,e),u=t,h(d),50<=(c+=1)&&(l.classList.remove("appShuffle"),clearInterval(y),o=!1)},70)))}),document.body.addEventListener("keydown",e=>{if(!o&&e.key.includes("Arrow")){var t=x(n,d),r={x:t.x,y:t.y},e=e.key.split("Arrow")[1].toLowerCase(),l=r,r=t;switch(e){case"up":l.y+=1;break;case"down":--l.y;break;case"left":l.x+=1;break;case"right":--l.x}b(l,r)}});if(a.length<t)throw new Error(`Должно быть ровно ${t} items in HTML`);a[t-1].style.display="none";var k=a.map(e=>Number(e.dataset.matrixId));d=(e=>{const t=[[],[],[],[]];let r=0,l=0;for(var a of e)l>=s&&(r++,l=0),t[r][l]=a,l++;return t})(k),h(d),f()};appPuzzle();